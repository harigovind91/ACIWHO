<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACIWHO GLOBAL | HAI Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;600;900&display=swap');
        body { font-family: 'Outfit', sans-serif; background: #ffffff; scroll-behavior: smooth; overflow-x: hidden; }
        
        .sector-card { border-radius: 45px; background: #fff; border: 1px solid #eee; transition: 0.4s; overflow: hidden; position: relative; }
        .sector-card:hover { transform: translateY(-10px); box-shadow: 0 30px 60px rgba(59, 130, 246, 0.1); border-color: #3b82f6; }
        
        #sideMenu { transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); transform: translateX(100%); z-index: 2000; }
        #sideMenu.open { transform: translateX(0); }
        
        #map { height: 250px; border-radius: 30px; margin-bottom: 20px; border: 4px solid #f8fafc; }

        /* Modern AI Chatbot UI */
        #chatBox { display: none; position: fixed; bottom: 100px; right: 25px; width: 350px; height: 500px; background: white; border-radius: 35px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.2); z-index: 5000; flex-direction: column; overflow: hidden; border: 1px solid #eef2f6; }
        .chat-msg { padding: 12px 16px; border-radius: 20px; font-size: 13px; max-width: 80%; margin-bottom: 10px; line-height: 1.5; }
        .msg-bot { background: #f1f5f9; color: #1e293b; border-bottom-left-radius: 4px; font-weight: 500; }
        .msg-user { background: #2563eb; color: white; border-bottom-right-radius: 4px; margin-left: auto; font-weight: 600; }

        /* Modal Blur */
        .modal-blur { backdrop-filter: blur(8px); background: rgba(15, 23, 42, 0.6); }
    </style>
</head>
<body class="bg-slate-50">

    <div id="google_translate_element" style="display:none"></div>

    <nav class="fixed top-0 w-full z-[1000] bg-white/90 backdrop-blur-xl border-b border-slate-100">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
                <span class="bg-blue-600 text-white px-3 py-1 rounded font-black italic text-sm">HAI</span>
                <span class="text-xl font-black uppercase tracking-tighter">ACIWHO <span class="text-blue-600">GLOBAL</span></span>
            </div>
            <div class="flex items-center gap-4">
                <div id="userLocation" class="hidden md:flex items-center gap-2 text-[10px] font-bold text-slate-500 uppercase bg-slate-100 px-4 py-2 rounded-full italic">üìç Detecting Location...</div>
                <button onclick="toggleMenu()" class="w-12 h-12 bg-slate-900 text-white rounded-2xl flex items-center justify-center hover:bg-blue-600 transition-all shadow-lg">
                    <i class="fas fa-th-large"></i>
                </button>
            </div>
        </div>
    </nav>

    <div id="sideMenu" class="fixed top-0 right-0 h-full w-full md:w-[450px] bg-white p-8 overflow-y-auto shadow-2xl">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-2xl font-black italic uppercase">HAI <span class="text-blue-600">Network</span></h2>
            <button onclick="toggleMenu()" class="text-3xl text-slate-300">&times;</button>
        </div>
        <div id="map"></div>
        <div class="space-y-4">
            <div class="bg-slate-50 p-6 rounded-[35px] border border-slate-100">
                <label class="text-[10px] font-black text-blue-600 uppercase block mb-2">Select Language</label>
                <select onchange="changeLanguage(this.value)" class="w-full bg-white border-0 text-sm font-bold p-3 rounded-2xl outline-none shadow-sm">
                    <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (India)</option>
                    <option value="en">English (Global)</option>
                    <option value="es">Espa√±ol</option>
                </select>
            </div>
            <button onclick="openRegistration()" class="w-full bg-slate-900 text-white p-6 rounded-[30px] font-black text-xs uppercase tracking-widest hover:bg-blue-600 transition-all flex justify-between items-center">
                Donor Registration <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <main class="pt-40 pb-32 px-6 container mx-auto">
        <div class="mb-20 text-center">
            <h1 class="text-6xl md:text-8xl font-black italic tracking-tighter uppercase leading-none mb-6">ACIWHO <br><span class="text-blue-600">Units</span></h1>
            <div class="h-1.5 w-24 bg-blue-600 mx-auto rounded-full"></div>
        </div>
        <div class="grid md:grid-cols-3 gap-8" id="sector-grid"></div>
    </main>

    <div id="donateModal" class="fixed inset-0 z-[6000] hidden items-center justify-center p-4 modal-blur">
        <div class="bg-white w-full max-w-md rounded-[45px] p-8 shadow-2xl transform transition-all">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-black italic uppercase text-slate-900">Support <span class="text-blue-600" id="modalUnitName">Unit</span></h2>
                <button onclick="closeDonateModal()" class="text-3xl text-slate-300 hover:text-black">&times;</button>
            </div>
            <div class="space-y-6">
                <div>
                    <label class="text-[10px] font-black uppercase text-slate-400 ml-2">Amount (INR)</label>
                    <input type="number" id="donateAmount" class="w-full bg-slate-50 border-2 border-transparent focus:border-blue-600 p-5 rounded-[25px] outline-none font-bold text-2xl" placeholder="1000">
                </div>
                <div class="grid grid-cols-3 gap-3">
                    <button onclick="setAmount(500)" class="bg-slate-100 py-3 rounded-2xl text-xs font-black hover:bg-blue-600 hover:text-white transition-all">‚Çπ500</button>
                    <button onclick="setAmount(1000)" class="bg-slate-100 py-3 rounded-2xl text-xs font-black hover:bg-blue-600 hover:text-white transition-all">‚Çπ1000</button>
                    <button onclick="setAmount(5000)" class="bg-slate-100 py-3 rounded-2xl text-xs font-black hover:bg-blue-600 hover:text-white transition-all">‚Çπ5000</button>
                </div>
                <button onclick="processUPIDonation()" class="w-full bg-blue-600 text-white p-6 rounded-[30px] font-black text-xs uppercase tracking-widest shadow-xl shadow-blue-200 flex items-center justify-center gap-3 hover:scale-105 transition-transform">
                    <i class="fas fa-bolt"></i> Pay via UPI
                </button>
                <p class="text-[9px] text-center text-slate-400 font-bold uppercase tracking-widest">
                    <i class="fas fa-shield-alt text-green-500 mr-1"></i> End-to-End Encrypted via HAI Secure
                </p>
            </div>
        </div>
    </div>

    <div id="chatBox">
        <div class="bg-slate-900 p-6 text-white flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                <span class="font-black italic text-sm tracking-widest uppercase">HAI Assistant</span>
            </div>
            <button onclick="toggleChat()"><i class="fas fa-times"></i></button>
        </div>
        <div id="chatContent" class="flex-1 p-6 overflow-y-auto bg-slate-50 flex flex-col">
            <div class="chat-msg msg-bot">‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç HAI (Hari AI) ‡§π‡•Ç‡§Å‡•§ ‡§Æ‡•à‡§Ç ACIWHO ‡§Æ‡§ø‡§∂‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§î‡§∞ ‡§°‡•ã‡§®‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å‡•§ ‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?</div>
        </div>
        <div class="p-4 bg-white border-t flex gap-2">
            <input type="text" id="chatInput" placeholder="Type a message..." class="flex-1 bg-slate-100 p-4 rounded-2xl text-xs font-bold outline-none border-0">
            <button onclick="sendChat()" class="w-12 h-12 bg-blue-600 text-white rounded-2xl flex items-center justify-center shadow-lg">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <button onclick="toggleChat()" class="fixed bottom-8 right-8 w-16 h-16 bg-blue-600 text-white rounded-full shadow-2xl flex items-center justify-center text-2xl hover:scale-110 transition-all z-[4000]">
        <i class="fas fa-comment-dots"></i>
    </button>

    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    <script>
        const SB_URL = "https://d0616364-4643-4c6f-a6dc-57a0bc65d7ed.supabase.co"; 
        const SB_KEY = "sba_0a2432244391098827fa8aeedce7bf2a0791a95c";
        const _supabase = supabase.createClient(SB_URL, SB_KEY);

        const sectors = [
            {id:'01', t:'IT & Robotics', d:'AI-‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ ‡§ó‡§µ‡§∞‡•ç‡§®‡•á‡§Ç‡§∏ ‡§î‡§∞ ‡§∞‡§æ‡§π‡§§ ‡§°‡•ç‡§∞‡•ã‡§® ‡§≤‡•à‡§¨‡•§', img:'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?auto=format&fit=crop&w=800'},
            {id:'02', t:'Digital Skills', d:'‡§ó‡•ç‡§∞‡§æ‡§Æ‡•Ä‡§£ ‡§Ø‡•Å‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§∏‡§æ‡§Ø‡§¨‡§∞ ‡§∏‡§ø‡§ï‡•ç‡§Ø‡•ã‡§∞‡§ø‡§ü‡•Ä ‡§∏‡•á‡§Ç‡§ü‡§∞‡•§', img:'https://images.unsplash.com/photo-1516321318423-f06f85e504b3?auto=format&fit=crop&w=800'},
            {id:'03', t:'Health Unit', d:'‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§π‡•â‡§∏‡•ç‡§™‡§ø‡§ü‡§≤ ‡§î‡§∞ 24/7 ‡§ü‡•á‡§≤‡•Ä-‡§Æ‡•á‡§°‡§ø‡§∏‡§ø‡§® ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï‡•§', img:'https://images.unsplash.com/photo-1538108190935-61bb30dff19a?auto=format&fit=crop&w=800'},
            {id:'04', t:'Food Security', d:'‡§¨‡•ç‡§≤‡•â‡§ï‡§ö‡•á‡§® ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§Ö‡§®‡•ç‡§® ‡§¨‡•à‡§Ç‡§ï ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó‡•§', img:'https://images.unsplash.com/photo-1547592166-23ac45744acd?auto=format&fit=crop&w=800'},
            {id:'05', t:'Nari Shakti', d:'‡§Æ‡§π‡§ø‡§≤‡§æ ‡§â‡§¶‡•ç‡§Ø‡§Æ‡§ø‡§§‡§æ ‡§î‡§∞ ‡§°‡§ø‡§´‡•á‡§Ç‡§∏ ‡§ü‡•ç‡§∞‡•á‡§®‡§ø‡§Ç‡§ó ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ‡•§', img:'https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?auto=format&fit=crop&w=800'},
            {id:'06', t:'Nature Lab', d:'‡§°‡•ç‡§∞‡•ã‡§® ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§µ‡•É‡§ï‡•ç‡§∑‡§æ‡§∞‡•ã‡§™‡§£ ‡§î‡§∞ ‡§∞‡§ø‡§∏‡§æ‡§á‡§ï‡•ç‡§≤‡§ø‡§Ç‡§ó ‡§™‡•ç‡§≤‡§æ‡§Ç‡§ü‡•§', img:'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=800'},
            {id:'07', t:'Legal Cell', d:'‡§Æ‡§æ‡§®‡§µ‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§î‡§∞ ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ‡•§', img:'https://images.unsplash.com/photo-1505664194779-8beaceb93744?auto=format&fit=crop&w=800'},
            {id:'08', t:'Global Team', d:'100+ ‡§¶‡•á‡§∂‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§¶‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§µ‡§æ‡§π‡§ø‡§®‡•Ä‡•§', img:'https://images.unsplash.com/photo-1511632765486-a01980e01a18?auto=format&fit=crop&w=800'},
            {id:'09', t:'Finance Unit', d:'‡§∞‡§ø‡§Ø‡§≤-‡§ü‡§æ‡§á‡§Æ ‡§¨‡•ç‡§≤‡•â‡§ï‡§ö‡•á‡§® ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§´‡§Ç‡§° ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó‡•§', img:'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?auto=format&fit=crop&w=800'}
        ];

        let currentCountry = "India";
        let selectedUnit = "";
        let map;

        window.onload = async () => {
            renderGrid();
            try {
                const res = await fetch('https://ipapi.co/json/');
                const data = await res.json();
                currentCountry = data.country_name;
                document.getElementById('userLocation').innerHTML = `üìç ${data.city}, ${data.country_name}`;
                initMap(data.latitude, data.longitude);
            } catch(e) { initMap(20.59, 78.96); }
        };

        function initMap(lat, lon) {
            if(map) map.remove();
            map = L.map('map', {zoomControl: false}).setView([lat, lon], 4);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
            L.marker([lat, lon]).addTo(map);
        }

        function renderGrid() {
            const grid = document.getElementById('sector-grid');
            grid.innerHTML = sectors.map(s => `
                <div class="sector-card p-8">
                    <img src="${s.img}" class="w-full h-48 object-cover rounded-[35px] mb-6 shadow-sm">
                    <h3 class="text-2xl font-black italic uppercase mb-2">${s.t}</h3>
                    <p class="text-slate-500 text-sm mb-8 font-medium">${s.d}</p>
                    <button onclick="initiatePayment('${s.t}')" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-black text-[10px] uppercase tracking-widest shadow-lg shadow-blue-50">Donate Now</button>
                </div>
            `).join('');
        }

        // Donation Modal Logic
        function initiatePayment(unit) {
            selectedUnit = unit;
            document.getElementById('modalUnitName').innerText = unit;
            document.getElementById('donateModal').style.display = 'flex';
        }

        function closeDonateModal() { document.getElementById('donateModal').style.display = 'none'; }
        function setAmount(amt) { document.getElementById('donateAmount').value = amt; }

        async function processUPIDonation() {
            const amount = document.getElementById('donateAmount').value;
            if(!amount || amount <= 0) return alert("‡§µ‡•à‡§ß ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç");

            const upiUrl = `upi://pay?pa=43137160754@sbi&pn=ACIWHO_GLOBAL&am=${amount}&cu=INR&tn=HAI_${selectedUnit.replace(/\s/g,'')}`;
            
            // Open UPI App
            const link = document.createElement('a');
            link.href = upiUrl;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            // Supabase Log
            await _supabase.from('donations').insert([{ amount: parseFloat(amount), unit_name: selectedUnit, location: currentCountry }]);
            closeDonateModal();
        }

        // AI Chatbot Logic
        function toggleChat() {
            const cb = document.getElementById('chatBox');
            cb.style.display = (cb.style.display === 'flex') ? 'none' : 'flex';
        }

        function sendChat() {
            const input = document.getElementById('chatInput');
            const content = document.getElementById('chatContent');
            if(!input.value) return;

            const userMsg = input.value;
            content.innerHTML += `<div class="chat-msg msg-user">${userMsg}</div>`;
            input.value = '';
            content.scrollTop = content.scrollHeight;

            // AI Logic
            setTimeout(() => {
                let reply = "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§∏‡§Æ‡§ù ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å‡•§ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§Æ‡§ø‡§∂‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ø‡§æ ‡§°‡•ã‡§®‡•á‡§∂‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?";
                const msg = userMsg.toLowerCase();
                
                if(msg.includes("donate") || msg.includes("‡§¶‡§æ‡§®")) reply = "‡§Ü‡§™ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§Æ‡§ø‡§∂‡§® ‡§ï‡§æ‡§∞‡•ç‡§° ‡§™‡§∞ 'Donate Now' ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ UPI (GPay/PhonePe) ‡§∏‡•á ‡§¶‡§æ‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§";
                else if(msg.includes("unit") || msg.includes("‡§Æ‡§ø‡§∂‡§®")) reply = "‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ 9 ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ø‡•Ç‡§®‡§ø‡§ü‡•ç‡§∏ ‡§π‡•à‡§Ç: IT, Digital Skills, Health, Food Security, Nari Shakti, Nature, Legal, Global Team ‡§î‡§∞ Finance‡•§";
                else if(msg.includes("hello") || msg.includes("‡§®‡§Æ‡§∏‡•ç‡§§‡•á")) reply = "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç HAI Assistant ‡§π‡•Ç‡§Å‡•§ ‡§¨‡§§‡§æ‡§á‡§è ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•ç‡§Ø‡§æ ‡§∏‡•á‡§µ‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å?";
                else if(msg.includes("who") || msg.includes("kaun")) reply = "ACIWHO Global ‡§è‡§ï ‡§∏‡§æ‡§Æ‡§æ‡§ú‡§ø‡§ï ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ü‡•á‡§ï‡•ç‡§®‡•ã‡§≤‡•â‡§ú‡•Ä ‡§î‡§∞ ‡§Æ‡§æ‡§®‡§µ‡§§‡§æ ‡§ï‡•á ‡§∏‡§Ç‡§ó‡§Æ ‡§∏‡•á ‡§∏‡§Æ‡§æ‡§ú ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§ï‡§æ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§";

                content.innerHTML += `<div class="chat-msg msg-bot">${reply}</div>`;
                content.scrollTop = content.scrollHeight;
            }, 800);
        }

        // Other Utilities
        function toggleMenu() { document.getElementById('sideMenu').classList.toggle('open'); }
        function changeLanguage(lang) {
            const select = document.querySelector('.goog-te-combo');
            if(select) { select.value = lang; select.dispatchEvent(new Event('change')); }
        }
        function googleTranslateElementInit() { new google.translate.TranslateElement({pageLanguage: 'hi'}, 'google_translate_element'); }
        async function openRegistration() {
            const name = prompt("‡§Ö‡§™‡§®‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç:");
            const phone = prompt("‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§®‡§Ç‡§¨‡§∞:");
            if(name && phone) {
                const { error } = await _supabase.from('donors').insert([{ name, phone, country: currentCountry }]);
                if(!error) alert("‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§´‡§≤! HAI ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à‡•§");
            }
        }
    </script>
</body>
</html>
